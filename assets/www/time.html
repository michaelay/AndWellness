<html>
<head>
   <meta name="viewport" content="height=device-height,width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=no;" />
   <link rel="stylesheet" href="css/default.css" type="text/css">
   <link rel="stylesheet" href="css/default-basic.css" type="text/css">
   <link rel="stylesheet" href="http://m.ucla.edu/assets/css.php" type="text/css">
<script src="http://m.ucla.edu/assets/js.php"></script>
<script src="js/jquery-1.6.1.min.js"></script>
<script src="js/aws_campaign.js"></script>
<script src="js/aws_utility.js"></script>
<script src="js/aws_auth.js"></script>
<script src="js/jquery.cookie.js"></script>
<script src="plugin/TimeTrigger.js"></script>
</head>
<body onLoad="time_trigger()">
<h1 id="header" class="header center">AndWellness</h1>
<div class="menu-full menu-detailed menu-padded">
   <h1 class="light menu-first"> Trigger Time</h1>
   <ol>
   <li id="inst" class="smallprint" style="text-align:center;">24 hour format</li>
   <li align="center" style="text-align:center;">
   <select name="hours" id="hours">
		<script type="text/javascript">
				for(i=0;i<=23;i++)
				{ 
						if(i<10) document.write("<option value=0"+i+">"+"0"+i+"</option>");
						else document.write("<option value="+i+">"+i+"</option>");
				}
		</script>
	</select>
	<select name="minutes" id="minutes">
		<script type="text/javascript">
				for(i=0;i<60;i++)
				{ 
						if(i<10) document.write("<option value=0"+i+">"+"0"+i+"</option>");
						else document.write("<option value="+i+">"+i+"</option>");
				}
		</script>
	</select>
	</li>
	</ol>
</div>
<div class="menu-full menu-detailed menu-padded">
	<h1 class="light form-first">Repeat</h1>
	<ol>
	<li><input id="mon" type="checkbox" name="mon" value="M" /> Monday</li>
	<li><input id="tue" type="checkbox" name="tue" value="T"/> Tuesday</li>
	<li><input id="wed" type="checkbox" name="wed" value="W"/> Wednesday</li>        <li><input id="thurs" type="checkbox" name="thurs" value="TH"/> Thursday </li>
	<li><input id="fri" type="checkbox" name="fri" value="F" /> Friday</li>          <li><input id="sat" type="checkbox" name="sat" value="ST" /> Saturday </li>
	<li><input id="sun" type="checkbox" name="sun" value="S"/> Sunday</li>
	</ol>
</div>
<div class="menu-full menu-detailed menu-padded">
   <h1 class="light form-first">Surveys</h1>
   <ol id="survey-list"></ol>
</div>
<div class="button-full button-padded">
    <a href="createnew.html" class="button-first" onClick="submit()">Done</a>
    <a class="button-last" onClick="history.go(-1);return true;">Cancel</a>
</div>
<a href="index.html" class="button-full button-padded" onclick="logout()">Logout</a>
<script type="text/javascript">
function time_trigger()
{ 
	var loader = new CampaignXMLLoader(); 
   	var xmlString = loader.loadDefaultCampaign(); 

   	// print out the titles 
   	$(xmlString).find("survey").each(function() { 
      var title = $(this).children("title_t").text();
      var id = $(this).children("id").text();
      $("#survey-list").append('<li><input type=checkbox id=\"surveys\" name=\"surveys\" value=' + id + ' />'+title+'</li>'); 
   	});
   	$("#survey-list:last-child").addClass("menu-last");
};
</script>
<script type="text/javascript">
function submit()
{
	var time = document.getElementById("hours").value + ":" + document.getElementById("minutes").value;
	var repeat = [];
    	$("#repeat").find('input:checkbox:checked').each(function() { repeat.push($(this).val());});
	var survey_id = [];
   	$("#survey-list").find('input:checkbox:checked').each(function() { survey_id.push($(this).val());});
        
    	var dataString = {time:time,repeat:repeat,survey_id:survey_id};
    
    	var dataObj = JSON.stringify(dataString);
    	//alert(dataObj);    
	    var timetrigger = new TimeTrigger();
    
	    timetrigger.set(dataObj,
	    function(r){
	    alert("Time Trigger added");    
	    },
	  	function(e){
		alert("Could not add Time Trigger");
		}    
	    );
};
</script>
<script>
$(document).ready(function() { if (getLogin() == null) { window.location.replace("index.html"); }});
</script>
</body>
</html>
